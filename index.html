<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My First Auth App</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: sans-serif; padding: 2em; text-align: center; }
        button { font-size: 1.2em; padding: 0.5em 1em; margin-top: 1em; cursor: pointer; }
        #userInfo { margin-top: 1em; font-size: 1.5em; color: green; font-weight: bold; }
        #status { font-style: italic; color: #555; }
    </style>
</head>
<body>

    <h1>Supabase Auth Test</h1>
    <div id="status">Checking login status...</div>
    <div id="userInfo"></div>
    <button id="loginBtn">Log In with Facebook</button>
    <button id="logoutBtn" style="display:none;">Log Out</button>

    <script>
        // --- CONFIGURATION ---
        const SUPABASE_URL = 'https://fvjkqfrsxraivxomdywc.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ2amtxZnJzeHJhaXZ4b21keXdjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQzNzg2MzMsImV4cCI6MjA2OTk1NDYzM30.QqimcxoaZ0WHT_jvAlGjyWZ6lVbJ9g9iOyyDrUh-r24';

        // --- APP LOGIC ---
        const { createClient } = supabase;
        const _supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

        const loginButton = document.getElementById('loginBtn');
        const logoutButton = document.getElementById('logoutBtn');
        const userInfoDiv = document.getElementById('userInfo');
        const statusDiv = document.getElementById('status');

        const logInWithFacebook = async () => {
            await _supabase.auth.signInWithOAuth({ provider: 'facebook' });
        };

        const logout = async () => {
            await _supabase.auth.signOut();
        };

        loginButton.addEventListener('click', logInWithFacebook);
        logoutButton.addEventListener('click', logout);

        _supabase.auth.onAuthStateChange((event, session) => {
            if (session && session.user) {
                // User is logged in
                const userName = session.user.user_metadata.full_name || session.user.email;
                userInfoDiv.innerText = `Hello, ${userName}`;
                statusDiv.innerText = 'You are logged in.';
                loginButton.style.display = 'none';
                logoutButton.style.display = 'block';
            } else {
                // User is logged out
                userInfoDiv.innerText = '';
                statusDiv.innerText = 'You are not logged in.';
                loginButton.style.display = 'block';
                logoutButton.style.display = 'none';
            }
        });
    </script>

</body>
</html>
